---
- name: Set up the Archlinux host
  hosts: all
  tasks:

    - name: install packages
      pacman:
        name:
          - fbdump  # Provides fbdump
          - netpbm  # Provides pnmcrop
          - libpng  # Provides pnm2png
          - rsync
        state: present

    - name: copy the scripts
      copy:
        src: '{{ item }}'
        dest: /root/{{ item }}
        mode: 0755
      with_items:
        - gen-fonts-images.py
        - gen-fonts-data.py

    - name: generate fonts images
      command: openvt --wait --switch /root/gen-fonts-images.py
      args:
        creates: /root/screenshots

    - name: generate fonts data
      command: /root/gen-fonts-data.py
      args:
        creates: /root/fonts.yaml
